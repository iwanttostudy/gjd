(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{"2b8b":function(t,e,n){"use strict";n.r(e);var s=n("8ad8"),i=n("30c6");for(var o in i)"default"!==o&&function(t){n.d(e,t,(function(){return i[t]}))}(o);n("9843");var a,r=n("f0c5"),u=Object(r["a"])(i["default"],s["b"],s["c"],!1,null,"dc7740f2",null,!1,s["a"],a);e["default"]=u.exports},"2d7f":function(t,e,n){"use strict";(function(t){n("2be1");s(n("66fd"));var e=s(n("2b8b"));function s(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},"30c6":function(t,e,n){"use strict";n.r(e);var s=n("50d1"),i=n.n(s);for(var o in s)"default"!==o&&function(t){n.d(e,t,(function(){return s[t]}))}(o);e["default"]=i.a},"50d1":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=n("ee34"),i=function(){n.e("components/post-list/post-list").then(function(){return resolve(n("de0e"))}.bind(null,n)).catch(n.oe)},o=function(){n.e("components/post-waterfall/post-waterfall").then(function(){return resolve(n("cd05"))}.bind(null,n)).catch(n.oe)},a={components:{postList:i,postWaterfall:o},data:function(){return{swiperList:[],tabs:[{tab_name:"关注",postList:[]},{tab_name:"推荐",postList:[]},{tab_name:t.getStorageSync("district")||"同城",postList:[]}],current:1,swiperCurrent:1,videoCurrent:0,loadStatus:"loadmore",storageTopicList:[],page:1,pageNear:1,pageFllow:1,shareCover:"",topTopicList:[],topDisList:[]}},onShareAppMessage:function(t){return"button"===t.from&&console.log(t.target),{title:this.$c.miniappName,path:"/pages/index/index",imageUrl:this.shareCover}},onLoad:function(){this.getLocation(),this.getPostList(),this.storageTopicList=t.getStorageSync("topicList"),this.getSysInfo(),this.getLinkList(),this.getTopTopic(),this.getDisTopic()},onPullDownRefresh:function(){this.page1=1,this.page2=1,this.page3=1,this.tabs.postList=[],this.getPostList(),t.stopPullDownRefresh(),this.$refs.waterfall.clear(),this.nearbyPostList=[],this.getNearbyPost()},methods:{onSwiper:function(e){t.navigateTo({url:"/pages/webview/webview?src="+this.swiperList[e].url})},getDisTopic:function(){var t=this;this.$H.get("discuss/list",{top_type:1}).then((function(e){t.topDisList=e.result.data}))},getTopTopic:function(){var t=this;this.$H.get("topic/list",{top_type:1}).then((function(e){t.topTopicList=e.result.data}))},getLinkList:function(){var t=this;this.$H.post("link/list",{type:3,page:1}).then((function(e){t.swiperList=e.result.data}))},tabsChange:function(t){this.swiperCurrent=t},transition:function(t){var e=t.detail.dx;this.$refs.uTabs.setDx(e)},animationfinish:function(t){var e=t.detail.current;this.$refs.uTabs.setFinishCurrent(e),this.swiperCurrent=e,this.current=e,this.changeGetData(e)},onreachBottom:function(){0===this.current&&(this.pageFllow++,this.getFollowPost()),1===this.current&&(this.page++,this.getPostList()),2===this.current&&(this.pageNear++,this.getNearbyPost())},getNearbyPost:function(){var e=this;this.loadStatus="loading";var n=t.getStorageSync("location_info");this.$H.get("post/nearbyPost",{lat:n.latitude,lng:n.longitude,page:this.pageNear}).then((function(t){e.tabs[2].postList=e.tabs[2].postList.concat(t.result.data),t.result.current_page===t.result.last_page||0===t.result.last_page?e.loadStatus="nomore":e.loadStatus="loadmore"}))},getLocation:function(){var e=this;t.getLocation({type:"wgs84",success:function(n){var i=new s({key:"BMYBZ-GV464-JESUX-DZL53-Z6LNH-U6BIA"});i.reverseGeocoder({location:n,success:function(n){e.tabs[2].tab_name=n.result.ad_info.district,t.setStorageSync("district",n.result.ad_info.district)},fail:function(t){},complete:function(t){}}),t.setStorageSync("location_info",n),e.showOpenLocation=!1}})},getSysInfo:function(){var t=this;this.$H.get("system/miniConfig").then((function(e){t.shareCover=e.result.intro}))},changeGetData:function(t){0==this.tabs[t].postList.length&&(0==t?this.getFollowPost():2===t?this.getNearbyPost():this.getPostList())},getPostList:function(){var t=this;this.loadStatus="loading";var e=1,n=this.page;this.$H.get("post/list",{type:e,page:n}).then((function(e){t.tabs[t.current].postList=t.tabs[t.current].postList.concat(e.result.data),e.result.current_page===e.result.last_page||0===e.result.last_page?t.loadStatus="nomore":t.loadStatus="loadmore"}))},getFollowPost:function(){var t=this;this.loadStatus="loading",this.$H.post("post/followUserPost",{page:this.pageFllow}).then((function(e){t.tabs[t.current].postList=t.tabs[t.current].postList.concat(e.result.data),e.result.current_page===e.result.last_page||0===e.result.last_page?t.loadStatus="nomore":t.loadStatus="loadmore"}))}}};e.default=a}).call(this,n("543d")["default"])},"50e3":function(t,e,n){},"8ad8":function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return s}));var s={uNavbar:function(){return n.e("uview-ui/components/u-navbar/u-navbar").then(n.bind(null,"ec70"))},uTabsSwiper:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-tabs-swiper/u-tabs-swiper")]).then(n.bind(null,"a2de"))},postList:function(){return n.e("components/post-list/post-list").then(n.bind(null,"de0e"))},uSwiper:function(){return n.e("uview-ui/components/u-swiper/u-swiper").then(n.bind(null,"4eea"))},uIcon:function(){return n.e("uview-ui/components/u-icon/u-icon").then(n.bind(null,"7e78"))},postWaterfall:function(){return n.e("components/post-waterfall/post-waterfall").then(n.bind(null,"cd05"))}},i=function(){var t=this,e=t.$createElement;t._self._c},o=[]},9843:function(t,e,n){"use strict";var s=n("50e3"),i=n.n(s);i.a}},[["2d7f","common/runtime","common/vendor"]]]);